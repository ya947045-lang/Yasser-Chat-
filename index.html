<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#075e54">
    <title>Ø¯Ø±Ø¯Ø´Ø© Ù…ØµØ±ÙŠØ© - ØªØ·Ø¨ÙŠÙ‚ Ø¯Ø±Ø¯Ø´Ø© Ù…Ø¬Ø§Ù†ÙŠ</title>
    
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-messaging-compat.js"></script>
    
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #075e54, #128c7e);
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        /* Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
        .container {
            width: 100%;
            max-width: 400px;
            height: 90vh;
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            display: flex;
            flex-direction: column;
        }
        
        /* Ø§Ù„Ù‡ÙŠØ¯Ø± */
        .header {
            background: #075e54;
            color: white;
            padding: 20px;
            text-align: center;
            font-size: 20px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        /* Ø§Ù„Ø´Ø§Ø´Ø§Øª */
        .screen {
            flex: 1;
            display: none;
            flex-direction: column;
            overflow: hidden;
        }
        
        .screen.active {
            display: flex;
        }
        
        /* Ø´Ø§Ø´Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ */
        .login-screen {
            padding: 30px;
            text-align: center;
        }
        
        .app-logo {
            font-size: 60px;
            margin: 20px 0;
            color: #075e54;
        }
        
        .app-title {
            color: #075e54;
            margin-bottom: 10px;
            font-size: 24px;
        }
        
        .app-subtitle {
            color: #666;
            margin-bottom: 30px;
            line-height: 1.5;
        }
        
        .input-group {
            margin-bottom: 15px;
            text-align: right;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 5px;
            color: #333;
            font-weight: 500;
        }
        
        .input-group input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
        }
        
        .input-group input:focus {
            border-color: #25d366;
            outline: none;
        }
        
        .phone-input {
            display: flex;
            gap: 10px;
        }
        
        .country-code {
            background: #f0f0f0;
            padding: 12px;
            border-radius: 10px;
            font-weight: bold;
            min-width: 70px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
        .btn {
            background: #25d366;
            color: white;
            border: none;
            padding: 15px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            margin-top: 10px;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .btn:hover {
            background: #1da851;
            transform: translateY(-2px);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .btn-secondary {
            background: #f0f0f0;
            color: #333;
        }
        
        /* Ø´Ø§Ø´Ø© OTP */
        .otp-screen {
            padding: 30px;
            text-align: center;
        }
        
        .otp-title {
            color: #075e54;
            margin-bottom: 10px;
            font-size: 22px;
        }
        
        .otp-subtitle {
            color: #666;
            margin-bottom: 30px;
        }
        
        .otp-inputs {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 30px;
            direction: ltr;
        }
        
        .otp-input {
            width: 45px;
            height: 45px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 20px;
            text-align: center;
            font-weight: bold;
        }
        
        .otp-input:focus {
            border-color: #25d366;
            outline: none;
        }
        
        /* Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¯Ø±Ø¯Ø´Ø§Øª */
        .chat-list-container {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        .search-bar {
            padding: 15px;
            background: white;
            border-bottom: 1px solid #eee;
        }
        
        .search-input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 20px;
            font-size: 14px;
            background: #f6f6f6;
        }
        
        .chat-list {
            flex: 1;
            overflow-y: auto;
        }
        
        .chat-item {
            display: flex;
            padding: 15px;
            border-bottom: 1px solid #f0f0f0;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .chat-item:hover {
            background: #f9f9f9;
        }
        
        .chat-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: #25d366;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 18px;
            margin-left: 15px;
        }
        
        .chat-info {
            flex: 1;
        }
        
        .chat-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }
        
        .chat-name {
            font-weight: 600;
            color: #333;
        }
        
        .chat-time {
            font-size: 12px;
            color: #999;
        }
        
        .chat-message {
            color: #666;
            font-size: 14px;
            max-width: 80%;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        /* Ø´Ø§Ø´Ø© Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© */
        .messages-container {
            flex: 1;
            background: #e5ddd5;
            padding: 15px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            background-image: url('https://web.whatsapp.com/img/bg-chat-tile-light_686b98c9fdffef3f63127759e2057750.png');
            background-size: contain;
        }
        
        .message {
            max-width: 70%;
            padding: 10px 15px;
            border-radius: 18px;
            margin-bottom: 10px;
            position: relative;
            word-wrap: break-word;
            animation: messageAppear 0.3s ease-out;
        }
        
        @keyframes messageAppear {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .message.sent {
            background: #dcf8c6;
            align-self: flex-end;
            border-bottom-right-radius: 5px;
        }
        
        .message.received {
            background: white;
            align-self: flex-start;
            border-bottom-left-radius: 5px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }
        
        .message-text {
            margin-bottom: 5px;
        }
        
        .message-time {
            font-size: 11px;
            color: #999;
            text-align: left;
            direction: ltr;
        }
        
        .message.sent .message-time {
            text-align: right;
        }
        
        .input-area {
            padding: 15px;
            background: #f0f0f0;
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .message-input {
            flex: 1;
            padding: 12px 15px;
            border: none;
            border-radius: 20px;
            font-size: 14px;
            background: white;
        }
        
        .send-btn {
            background: #25d366;
            color: white;
            border: none;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }
        
        /* Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ */
        .contacts-container {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        .contacts-list {
            flex: 1;
            overflow-y: auto;
        }
        
        .contact-item {
            display: flex;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid #f0f0f0;
            cursor: pointer;
        }
        
        .contact-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 18px;
            margin-left: 15px;
        }
        
        .contact-info {
            flex: 1;
        }
        
        .contact-name {
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .contact-phone {
            color: #666;
            font-size: 14px;
            direction: ltr;
        }
        
        /* Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ */
        .profile-header {
            height: 150px;
            background: linear-gradient(135deg, #075e54, #128c7e);
            position: relative;
        }
        
        .profile-avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: white;
            border: 5px solid white;
            position: absolute;
            bottom: -50px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            color: #075e54;
        }
        
        .profile-body {
            padding: 70px 20px 20px;
        }
        
        .profile-info {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .profile-field {
            display: flex;
            justify-content: space-between;
            padding: 15px 0;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .profile-field:last-child {
            border-bottom: none;
        }
        
        .field-label {
            color: #666;
        }
        
        .field-value {
            color: #333;
            font-weight: 600;
        }
        
        /* Ø§Ù„ØªÙ†Ù‚Ù„ Ø§Ù„Ø³ÙÙ„ÙŠ */
        .bottom-nav {
            display: flex;
            background: white;
            border-top: 1px solid #eee;
            padding: 10px 0;
        }
        
        .nav-item {
            flex: 1;
            text-align: center;
            padding: 10px;
            color: #999;
            cursor: pointer;
            transition: color 0.3s;
            text-decoration: none;
        }
        
        .nav-item.active {
            color: #25d366;
        }
        
        .nav-item i {
            font-size: 20px;
            display: block;
            margin-bottom: 5px;
        }
        
        .nav-item span {
            font-size: 12px;
            font-weight: 500;
        }
        
        /* Ø§Ù„ØªØ­Ù…ÙŠÙ„ */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: white;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            flex-direction: column;
            gap: 20px;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #25d366;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ */
        .toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            z-index: 1000;
            animation: toastSlide 0.3s;
            display: none;
            max-width: 90%;
            text-align: center;
        }
        
        @keyframes toastSlide {
            from {
                opacity: 0;
                transform: translateX(-50%) translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
        }
        
        /* Ø²Ø± Ø¥Ø¶Ø§ÙØ© Ø¬Ù‡Ø© Ø§ØªØµØ§Ù„ */
        .add-contact-btn {
            position: fixed;
            bottom: 80px;
            right: 20px;
            background: #25d366;
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: none;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(37, 211, 102, 0.4);
            z-index: 100;
        }
        
        /* Ø¹Ù†Ø¯ Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ø¨ÙŠØ§Ù†Ø§Øª */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #999;
        }
        
        .empty-state i {
            font-size: 50px;
            margin-bottom: 15px;
            opacity: 0.5;
        }
        
        /* Ø²Ø± Ø§Ù„Ø±Ø¬ÙˆØ¹ */
        .back-btn {
            position: absolute;
            right: 20px;
            background: none;
            border: none;
            color: white;
            font-size: 20px;
            cursor: pointer;
            display: none;
        }
        
        /* Ø²Ø± ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ */
        .install-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            background: #25d366;
            color: white;
            padding: 10px 15px;
            border-radius: 20px;
            border: none;
            cursor: pointer;
            z-index: 1000;
            display: none;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            font-weight: 600;
        }
        
        /* Ø¬ÙˆØ§Ù„ */
        @media (max-width: 768px) {
            body {
                padding: 0;
                background: white;
            }
            
            .container {
                max-width: 100%;
                height: 100vh;
                border-radius: 0;
            }
            
            .back-btn {
                display: block;
            }
        }
    </style>
</head>
<body>
    <!-- Ø²Ø± ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ -->
    <button id="installBtn" class="install-btn">
        ğŸ“± ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
    </button>
    
    <!-- Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ -->
    <div id="loading" class="loading-overlay">
        <div class="spinner"></div>
        <div id="loadingText">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
    </div>
    
    <!-- Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ -->
    <div id="toast" class="toast"></div>
    
    <!-- Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
    <div class="container">
        <!-- Ø§Ù„Ù‡ÙŠØ¯Ø± -->
        <div class="header">
            <button id="backBtn" class="back-btn">
                <i class="fas fa-arrow-right"></i>
            </button>
            <div id="headerTitle">Ø¯Ø±Ø¯Ø´Ø© Ù…ØµØ±ÙŠØ©</div>
            <div style="width: 40px;"></div>
        </div>
        
        <!-- Ø´Ø§Ø´Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
        <div id="loginScreen" class="screen active">
            <div class="login-screen">
                <div class="app-logo">ğŸ’¬</div>
                <h1 class="app-title">Ø¯Ø±Ø¯Ø´Ø© Ù…ØµØ±ÙŠØ©</h1>
                <p class="app-subtitle">ØªØ·Ø¨ÙŠÙ‚ Ø¯Ø±Ø¯Ø´Ø© Ù…Ø¬Ø§Ù†ÙŠ ÙˆØ¢Ù…Ù† Ù„Ù„Ù…ØµØ±ÙŠÙŠÙ†.<br>ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø£ØµØ¯Ù‚Ø§Ø¦Ùƒ ÙˆØ¹Ø§Ø¦Ù„ØªÙƒ ÙÙŠ Ø£ÙŠ ÙˆÙ‚Øª.</p>
                
                <div class="input-group">
                    <label>Ø§Ù„Ø§Ø³Ù… Ø¨Ø§Ù„ÙƒØ§Ù…Ù„</label>
                    <input type="text" id="name" placeholder="Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯" required>
                </div>
                
                <div class="input-group">
                    <label>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ø§Ù„Ù…ØµØ±ÙŠ</label>
                    <div class="phone-input">
                        <div class="country-code">+20</div>
                        <input type="tel" id="phone" placeholder="1234567890" required>
                    </div>
                </div>
                
                <button class="btn" id="sendOtpBtn">
                    <i class="fas fa-mobile-alt"></i>
                    Ø¥Ø±Ø³Ø§Ù„ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚
                </button>
            </div>
        </div>
        
        <!-- Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù‚Ù‚ -->
        <div id="otpScreen" class="screen">
            <div class="otp-screen">
                <h2 class="otp-title">ØªØ­Ù‚Ù‚ Ù…Ù† Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</h2>
                <p class="otp-subtitle" id="otpSubtitle">ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ù…Ø² ØªØ­Ù‚Ù‚ Ø¥Ù„Ù‰ Ø±Ù‚Ù…Ùƒ</p>
                
                <div class="otp-inputs">
                    <input type="text" class="otp-input" maxlength="1" data-index="0">
                    <input type="text" class="otp-input" maxlength="1" data-index="1">
                    <input type="text" class="otp-input" maxlength="1" data-index="2">
                    <input type="text" class="otp-input" maxlength="1" data-index="3">
                    <input type="text" class="otp-input" maxlength="1" data-index="4">
                    <input type="text" class="otp-input" maxlength="1" data-index="5">
                </div>
                
                <button class="btn" id="verifyOtpBtn">
                    <i class="fas fa-check"></i>
                    ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø±Ù…Ø²
                </button>
                
                <button class="btn btn-secondary" id="resendOtpBtn">
                    <i class="fas fa-redo"></i>
                    Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ù…Ø²
                </button>
                
                <button class="btn btn-secondary" id="backToLoginBtn">
                    <i class="fas fa-arrow-right"></i>
                    Ø§Ù„Ø¹ÙˆØ¯Ø©
                </button>
            </div>
        </div>
        
        <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¯Ø±Ø¯Ø´Ø§Øª -->
        <div id="chatListScreen" class="screen">
            <div class="chat-list-container">
                <div class="search-bar">
                    <input type="text" class="search-input" placeholder="ğŸ” Ø§Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª...">
                </div>
                <div class="chat-list" id="chatList">
                    <!-- Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª ØªØ¸Ù‡Ø± Ù‡Ù†Ø§ -->
                </div>
            </div>
        </div>
        
        <!-- Ø´Ø§Ø´Ø© Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© -->
        <div id="chatScreen" class="screen">
            <div class="messages-container" id="messagesContainer">
                <!-- Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ØªØ¸Ù‡Ø± Ù‡Ù†Ø§ -->
            </div>
            <div class="input-area">
                <input type="text" class="message-input" id="messageInput" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„Ø©...">
                <button class="send-btn" id="sendBtn">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>
        
        <!-- Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ -->
        <div id="contactsScreen" class="screen">
            <div class="contacts-container">
                <div class="search-bar">
                    <input type="text" class="search-input" placeholder="ğŸ” Ø§Ø¨Ø­Ø« ÙÙŠ Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„...">
                </div>
                <div class="contacts-list" id="contactsList">
                    <!-- Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ ØªØ¸Ù‡Ø± Ù‡Ù†Ø§ -->
                </div>
            </div>
            <button class="add-contact-btn" id="addContactBtn">
                <i class="fas fa-user-plus"></i>
            </button>
        </div>
        
        <!-- Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ -->
        <div id="profileScreen" class="screen">
            <div class="profile-header">
                <div class="profile-avatar" id="profileAvatar">
                    <i class="fas fa-user"></i>
                </div>
            </div>
            <div class="profile-body">
                <div class="profile-info">
                    <div class="profile-field">
                        <span class="field-label">Ø§Ù„Ø§Ø³Ù…</span>
                        <span class="field-value" id="profileName">-</span>
                    </div>
                    <div class="profile-field">
                        <span class="field-label">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</span>
                        <span class="field-value" id="profilePhone">-</span>
                    </div>
                    <div class="profile-field">
                        <span class="field-label">Ø§Ù„Ø­Ø§Ù„Ø©</span>
                        <span class="field-value" id="profileStatus">Ù…ØªØµÙ„</span>
                    </div>
                </div>
                
                <button class="btn" id="editProfileBtn">
                    <i class="fas fa-edit"></i>
                    ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ
                </button>
                
                <button class="btn btn-secondary" id="logoutBtn">
                    <i class="fas fa-sign-out-alt"></i>
                    ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
                </button>
            </div>
        </div>
        
        <!-- Ø§Ù„ØªÙ†Ù‚Ù„ Ø§Ù„Ø³ÙÙ„ÙŠ -->
        <div class="bottom-nav">
            <a href="#" class="nav-item active" data-screen="chatListScreen">
                <i class="fas fa-comments"></i>
                <span>Ø§Ù„Ø¯Ø±Ø¯Ø´Ø§Øª</span>
            </a>
            <a href="#" class="nav-item" data-screen="contactsScreen">
                <i class="fas fa-users"></i>
                <span>Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„</span>
            </a>
            <a href="#" class="nav-item" data-screen="profileScreen">
                <i class="fas fa-user"></i>
                <span>Ø§Ù„Ù…Ù„Ù</span>
            </a>
        </div>
    </div>

    <!-- Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
    <script>
        // ============================================
        // âš™ï¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase - Ø¶Ø¹ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ù‡Ù†Ø§ âš™ï¸
        // ============================================
        const firebaseConfig = {
            apiKey: "AIzaSyDLm_HUbnNfRv4ZH9u08VQi7pmZzm1GgRk",
            authDomain: "yasser-chat-6c39c.firebaseapp.com",
            projectId: "yasser-chat-6c39c",
            storageBucket: "yasser-chat-6c39c.firebasestorage.app",
            messagingSenderId: "141483029088",
            appId: "1:141483029088:web:18787391e80466f6bbc905"
        };
        
        // ============================================
        // ğŸ”¥ ØªÙ‡ÙŠØ¦Ø© Firebase
        // ============================================
        try {
            // Initialize Firebase
            firebase.initializeApp(firebaseConfig);
            console.log("âœ… Firebase Ù…ØªØµÙ„ Ø¨Ù†Ø¬Ø§Ø­!");
        } catch (error) {
            console.error("âŒ Ø®Ø·Ø£ ÙÙŠ ØªÙ‡ÙŠØ¦Ø© Firebase:", error);
        }
        
        // ============================================
        // ğŸ“¦ Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        // ============================================
        const auth = firebase.auth();
        const db = firebase.firestore();
        const messaging = firebase.messaging?.isSupported() ? firebase.messaging() : null;
        
        let currentUser = null;
        let currentChat = null;
        let unsubscribeMessages = null;
        let unsubscribeChats = null;
        
        // ============================================
        // ğŸ¯ Ø¹Ù†Ø§ØµØ± DOM
        // ============================================
        const elements = {
            // Ø§Ù„Ø´Ø§Ø´Ø§Øª
            loginScreen: document.getElementById('loginScreen'),
            otpScreen: document.getElementById('otpScreen'),
            chatListScreen: document.getElementById('chatListScreen'),
            chatScreen: document.getElementById('chatScreen'),
            contactsScreen: document.getElementById('contactsScreen'),
            profileScreen: document.getElementById('profileScreen'),
            
            // Ø§Ù„Ù‡ÙŠØ¯Ø±
            headerTitle: document.getElementById('headerTitle'),
            backBtn: document.getElementById('backBtn'),
            
            // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
            nameInput: document.getElementById('name'),
            phoneInput: document.getElementById('phone'),
            sendOtpBtn: document.getElementById('sendOtpBtn'),
            
            // OTP
            otpSubtitle: document.getElementById('otpSubtitle'),
            otpInputs: document.querySelectorAll('.otp-input'),
            verifyOtpBtn: document.getElementById('verifyOtpBtn'),
            resendOtpBtn: document.getElementById('resendOtpBtn'),
            backToLoginBtn: document.getElementById('backToLoginBtn'),
            
            // Ø§Ù„Ø¯Ø±Ø¯Ø´Ø§Øª
            chatList: document.getElementById('chatList'),
            
            // Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©
            messagesContainer: document.getElementById('messagesContainer'),
            messageInput: document.getElementById('messageInput'),
            sendBtn: document.getElementById('sendBtn'),
            
            // Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„
            contactsList: document.getElementById('contactsList'),
            addContactBtn: document.getElementById('addContactBtn'),
            
            // Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ
            profileName: document.getElementById('profileName'),
            profilePhone: document.getElementById('profilePhone'),
            profileStatus: document.getElementById('profileStatus'),
            profileAvatar: document.getElementById('profileAvatar'),
            editProfileBtn: document.getElementById('editProfileBtn'),
            logoutBtn: document.getElementById('logoutBtn'),
            
            // Ø§Ù„ØªÙ†Ù‚Ù„
            navItems: document.querySelectorAll('.nav-item'),
            
            // Ø§Ù„ØªØ­Ù…ÙŠÙ„ ÙˆØ§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª
            loading: document.getElementById('loading'),
            loadingText: document.getElementById('loadingText'),
            toast: document.getElementById('toast'),
            
            // ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
            installBtn: document.getElementById('installBtn')
        };
        
        // ============================================
        // ğŸ› ï¸ Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©
        // ============================================
        function showLoading(text) {
            elements.loadingText.textContent = text;
            elements.loading.style.display = 'flex';
        }
        
        function hideLoading() {
            elements.loading.style.display = 'none';
        }
        
        function showToast(message, duration = 3000) {
            elements.toast.textContent = message;
            elements.toast.style.display = 'block';
            setTimeout(() => {
                elements.toast.style.display = 'none';
            }, duration);
        }
        
        function showScreen(screenId) {
            // Ø¥Ø®ÙØ§Ø¡ ÙƒÙ„ Ø§Ù„Ø´Ø§Ø´Ø§Øª
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
            document.getElementById(screenId).classList.add('active');
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ†Ù‚Ù„
            elements.navItems.forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('data-screen') === screenId) {
                    item.classList.add('active');
                }
            });
            
            // ØªØ­Ø¯ÙŠØ« Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù‡ÙŠØ¯Ø±
            updateHeaderTitle(screenId);
            
            // Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡ Ø²Ø± Ø§Ù„Ø±Ø¬ÙˆØ¹
            elements.backBtn.style.display = screenId === 'chatScreen' ? 'block' : 'none';
        }
        
        function updateHeaderTitle(screenId) {
            const titles = {
                'loginScreen': 'Ø¯Ø±Ø¯Ø´Ø© Ù…ØµØ±ÙŠØ©',
                'otpScreen': 'ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø±Ù‚Ù…',
                'chatListScreen': 'Ø§Ù„Ø¯Ø±Ø¯Ø´Ø§Øª',
                'chatScreen': currentChat ? currentChat.name : 'Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©',
                'contactsScreen': 'Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„',
                'profileScreen': 'Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ'
            };
            elements.headerTitle.textContent = titles[screenId] || 'Ø¯Ø±Ø¯Ø´Ø© Ù…ØµØ±ÙŠØ©';
        }
        
        function formatPhoneNumber(phone) {
            if (phone.startsWith('+20')) {
                return '0' + phone.substring(3);
            }
            return phone;
        }
        
        function formatDisplayPhone(phone) {
            const formatted = formatPhoneNumber(phone);
            return formatted.replace(/(\d{4})(\d{3})(\d{4})/, '$1 $2 $3');
        }
        
        function getInitials(name) {
            if (!name) return '?';
            return name.split(' ').map(n => n[0]).join('').toUpperCase().substring(0, 2);
        }
        
        function generateUserId() {
            return 'user_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        }
        
        // ============================================
        // ğŸ“± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ
        // ============================================
        elements.sendOtpBtn.addEventListener('click', () => {
            const name = elements.nameInput.value.trim();
            const phone = '+20' + elements.phoneInput.value.trim();
            
            if (!name || name.length < 2) {
                showToast('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… ØµØ­ÙŠØ­');
                return;
            }
            
            if (!elements.phoneInput.value.trim() || elements.phoneInput.value.trim().length !== 10) {
                showToast('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ù‡Ø§ØªÙ Ù…ØµØ±ÙŠ ØµØ­ÙŠØ­ (10 Ø£Ø±Ù‚Ø§Ù…)');
                return;
            }
            
            showLoading('Ø¬Ø§Ø±ÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚...');
            
            // Ù…Ø­Ø§ÙƒØ§Ø© Ø¥Ø±Ø³Ø§Ù„ OTP
            setTimeout(() => {
                hideLoading();
                
                // Ø¥Ù†Ø´Ø§Ø¡ Ø±Ù…Ø² OTP Ø¹Ø´ÙˆØ§Ø¦ÙŠ
                window.generatedOtp = Math.floor(100000 + Math.random() * 900000).toString();
                
                // Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø¤Ù‚ØªØ§Ù‹
                window.tempUserData = {
                    name: name,
                    phone: phone,
                    otp: window.generatedOtp
                };
                
                // Ø¹Ø±Ø¶ Ø§Ù„Ø±Ù…Ø² Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…
                alert(`ğŸ“± Ù„Ø£ØºØ±Ø§Ø¶ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙˆØ¶ÙŠØ­ÙŠ ğŸ“±\n\nØ±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚: ${window.generatedOtp}\n\nÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØŒ Ø³ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ù‡Ø°Ø§ Ø§Ù„Ø±Ù…Ø² Ø¹Ø¨Ø± SMS Ø¥Ù„Ù‰ ${phone}`);
                
                // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© OTP
                elements.otpSubtitle.textContent = `ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ù…Ø² ØªØ­Ù‚Ù‚ Ø¥Ù„Ù‰ ${formatDisplayPhone(phone)}`;
                showScreen('otpScreen');
                elements.otpInputs[0].focus();
                
                showToast('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚');
            }, 1000);
        });
        
        // ============================================
        // âœ… ØªØ£ÙƒÙŠØ¯ Ø±Ù…Ø² OTP
        // ============================================
        elements.verifyOtpBtn.addEventListener('click', async () => {
            const otp = Array.from(elements.otpInputs).map(input => input.value).join('');
            
            if (otp.length !== 6) {
                showToast('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ù…ÙƒÙˆÙ† Ù…Ù† 6 Ø£Ø±Ù‚Ø§Ù…');
                return;
            }
            
            if (otp !== window.generatedOtp) {
                showToast('Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚ ØºÙŠØ± ØµØ­ÙŠØ­');
                return;
            }
            
            showLoading('Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨Ùƒ...');
            
            try {
                // Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ ÙÙŠ Firestore
                const userData = window.tempUserData;
                const userId = generateUserId();
                
                // Ø­ÙØ¸ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Firestore
                await db.collection('users').doc(userId).set({
                    uid: userId,
                    name: userData.name,
                    phone: userData.phone,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                    lastSeen: firebase.firestore.FieldValue.serverTimestamp(),
                    status: 'Ù…ØªØµÙ„',
                    avatarColor: '#' + Math.floor(Math.random()*16777215).toString(16)
                });
                
                // ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ
                currentUser = {
                    uid: userId,
                    name: userData.name,
                    phone: userData.phone
                };
                
                // Ø­ÙØ¸ ÙÙŠ localStorage
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                
                // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¤Ù‚ØªØ©
                delete window.tempUserData;
                delete window.generatedOtp;
                
                // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ØªØ­Ù…ÙŠÙ„ ÙˆØ¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù†Ø¬Ø§Ø­
                hideLoading();
                showToast(`Ù…Ø±Ø­Ø¨Ø§Ù‹ ${userData.name}!`);
                
                // Ø¹Ø±Ø¶ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
                showApp();
                
            } catch (error) {
                hideLoading();
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨:', error);
                showToast('Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨');
            }
        });
        
        // ============================================
        // ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ø±Ø³Ø§Ù„ OTP
        // ============================================
        elements.resendOtpBtn.addEventListener('click', () => {
            if (window.tempUserData) {
                window.generatedOtp = Math.floor(100000 + Math.random() * 900000).toString();
                alert(`ğŸ“± Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ø±Ø³Ø§Ù„ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚ ğŸ“±\n\nØ±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ø¬Ø¯ÙŠØ¯: ${window.generatedOtp}`);
                
                // Ù…Ø³Ø­ Ø­Ù‚ÙˆÙ„ OTP
                elements.otpInputs.forEach(input => input.value = '');
                elements.otpInputs[0].focus();
                
                showToast('ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ø±Ø³Ø§Ù„ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚');
            }
        });
        
        // ============================================
        // â†©ï¸ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        // ============================================
        elements.backToLoginBtn.addEventListener('click', () => {
            showScreen('loginScreen');
        });
        
        // ============================================
        // ğŸ’¬ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª
        // ============================================
        async function createChat(contactId, contactName, contactPhone) {
            showLoading('Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©...');
            
            try {
                // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©
                const chatId = [currentUser.uid, contactId].sort().join('_');
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©
                const chatDoc = await db.collection('chats').doc(chatId).get();
                
                if (!chatDoc.exists) {
                    // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø­Ø§Ø¯Ø«Ø© Ø¬Ø¯ÙŠØ¯Ø©
                    await db.collection('chats').doc(chatId).set({
                        participants: [currentUser.uid, contactId],
                        participantNames: [currentUser.name, contactName],
                        participantPhones: [currentUser.phone, contactPhone],
                        lastMessage: '',
                        lastMessageTime: firebase.firestore.FieldValue.serverTimestamp(),
                        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                        type: 'private'
                    });
                    
                    showToast(`Ø¨Ø¯Ø£Øª Ù…Ø­Ø§Ø¯Ø«Ø© Ù…Ø¹ ${contactName}`);
                }
                
                // ÙØªØ­ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©
                openChat(chatId, contactName);
                
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©:', error);
                showToast('Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©');
            } finally {
                hideLoading();
            }
        }
        
        function openChat(chatId, chatName) {
            currentChat = { id: chatId, name: chatName };
            showScreen('chatScreen');
            elements.messageInput.focus();
            loadMessages(chatId);
        }
        
        async function loadMessages(chatId) {
            if (unsubscribeMessages) unsubscribeMessages();
            
            elements.messagesContainer.innerHTML = '';
            
            try {
                unsubscribeMessages = db.collection('messages')
                    .doc(chatId)
                    .collection('messages')
                    .orderBy('timestamp', 'asc')
                    .onSnapshot(snapshot => {
                        elements.messagesContainer.innerHTML = '';
                        
                        snapshot.forEach(doc => {
                            const message = doc.data();
                            addMessageToUI(message);
                        });
                        
                        // Ø§Ù„ØªÙ…Ø±ÙŠØ± Ù„Ù„Ø£Ø³ÙÙ„
                        setTimeout(() => {
                            elements.messagesContainer.scrollTop = elements.messagesContainer.scrollHeight;
                        }, 100);
                    });
                    
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„:', error);
            }
        }
        
        async function sendMessage(text) {
            if (!text.trim() || !currentChat || !currentUser) return;
            
            try {
                const messageData = {
                    text: text.trim(),
                    senderId: currentUser.uid,
                    senderName: currentUser.name,
                    timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                    type: 'text'
                };
                
                // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø©
                await db.collection('messages')
                    .doc(currentChat.id)
                    .collection('messages')
                    .add(messageData);
                
                // ØªØ­Ø¯ÙŠØ« Ø¢Ø®Ø± Ø±Ø³Ø§Ù„Ø© ÙÙŠ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©
                await db.collection('chats').doc(currentChat.id).update({
                    lastMessage: text.trim(),
                    lastMessageTime: firebase.firestore.FieldValue.serverTimestamp()
                });
                
                // Ù…Ø³Ø­ Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„
                elements.messageInput.value = '';
                
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø©:', error);
                showToast('Ø®Ø·Ø£ ÙÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø©');
            }
        }
        
        function addMessageToUI(message) {
            const isSent = message.senderId === currentUser.uid;
            const messageElement = document.createElement('div');
            messageElement.className = `message ${isSent ? 'sent' : 'received'}`;
            
            const time = message.timestamp?.toDate ? 
                message.timestamp.toDate().toLocaleTimeString('ar-EG', { hour: '2-digit', minute: '2-digit' }) : 
                'Ø§Ù„Ø¢Ù†';
            
            messageElement.innerHTML = `
                <div class="message-text">${message.text}</div>
                <div class="message-time">${time}</div>
            `;
            
            elements.messagesContainer.appendChild(messageElement);
        }
        
        // ============================================
        // ğŸ“ Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø©
        // ============================================
        elements.sendBtn.addEventListener('click', () => {
            const message = elements.messageInput.value.trim();
            if (message) {
                sendMessage(message);
            }
        });
        
        elements.messageInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                const message = elements.messageInput.value.trim();
                if (message) {
                    sendMessage(message);
                }
            }
        });
        
        // ============================================
        // ğŸ”™ Ø²Ø± Ø§Ù„Ø±Ø¬ÙˆØ¹
        // ============================================
        elements.backBtn.addEventListener('click', () => {
            if (currentChat) {
                currentChat = null;
                showScreen('chatListScreen');
            }
        });
        
        // ============================================
        // ğŸ‘¥ Ø¥Ø¯Ø§Ø±Ø© Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„
        // ============================================
        async function loadContacts() {
            try {
                // Ø¬Ù‡Ø§Øª Ø§ØªØµØ§Ù„ ØªØ¬Ø±ÙŠØ¨ÙŠØ©
                const mockContacts = [
                    { id: '1', name: 'Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…ÙˆØ¯', phone: '+201234567890' },
                    { id: '2', name: 'Ù…Ø­Ù…Ø¯ Ø¹Ù„ÙŠ', phone: '+201098765432' },
                    { id: '3', name: 'Ø³Ø§Ø±Ø© Ø£Ø­Ù…Ø¯', phone: '+201112223344' }
                ];
                
                elements.contactsList.innerHTML = '';
                
                mockContacts.forEach(contact => {
                    const contactElement = document.createElement('div');
                    contactElement.className = 'contact-item';
                    
                    contactElement.innerHTML = `
                        <div class="contact-avatar">${getInitials(contact.name)}</div>
                        <div class="contact-info">
                            <div class="contact-name">${contact.name}</div>
                            <div class="contact-phone">${formatDisplayPhone(contact.phone)}</div>
                        </div>
                    `;
                    
                    contactElement.addEventListener('click', () => {
                        createChat(contact.id, contact.name, contact.phone);
                    });
                    
                    elements.contactsList.appendChild(contactElement);
                });
                
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„:', error);
            }
        }
        
        // ============================================
        // â• Ø¥Ø¶Ø§ÙØ© Ø¬Ù‡Ø© Ø§ØªØµØ§Ù„
        // ============================================
        elements.addContactBtn.addEventListener('click', () => {
            const name = prompt('Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø¬Ù‡Ø© Ø§Ù„Ø§ØªØµØ§Ù„:');
            const phone = prompt('Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ (10 Ø£Ø±Ù‚Ø§Ù…):');
            
            if (name && phone) {
                showToast(`ØªÙ… Ø¥Ø¶Ø§ÙØ© ${name} Ø¨Ù†Ø¬Ø§Ø­`);
                loadContacts(); // Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
            }
        });
        
        // ============================================
        // ğŸ‘¤ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ
        // ============================================
        async function loadUserProfile() {
            if (!currentUser) return;
            
            try {
                elements.profileName.textContent = currentUser.name;
                elements.profilePhone.textContent = formatDisplayPhone(currentUser.phone);
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£ÙØ§ØªØ§Ø±
                const avatarColor = '#075e54';
                elements.profileAvatar.innerHTML = `
                    <div style="width:100%;height:100%;border-radius:50%;background:${avatarColor};display:flex;align-items:center;justify-content:center;color:white;font-size:40px;">
                        ${getInitials(currentUser.name)}
                    </div>
                `;
                
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ:', error);
            }
        }
        
        // ============================================
        // âœï¸ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ
        // ============================================
        elements.editProfileBtn.addEventListener('click', () => {
            const newName = prompt('Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ø§Ù„Ø¬Ø¯ÙŠØ¯:', currentUser.name);
            if (newName && newName.trim() !== currentUser.name) {
                currentUser.name = newName.trim();
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                loadUserProfile();
                showToast('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø§Ø³Ù… Ø¨Ù†Ø¬Ø§Ø­');
            }
        });
        
        // ============================================
        // ğŸšª ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
        // ============================================
        elements.logoutBtn.addEventListener('click', () => {
            if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ØŸ')) {
                localStorage.removeItem('currentUser');
                currentUser = null;
                showScreen('loginScreen');
                showToast('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬');
            }
        });
        
        // ============================================
        // ğŸ“ Ø§Ù„ØªÙ†Ù‚Ù„
        // ============================================
        elements.navItems.forEach(item => {
            item.addEventListener('click', (e) => {
                e.preventDefault();
                const screenId = item.getAttribute('data-screen');
                showScreen(screenId);
            });
        });
        
        // ============================================
        // ğŸ“± PWA - ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        // ============================================
        let deferredPrompt;
        
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            elements.installBtn.style.display = 'block';
        });
        
        elements.installBtn.addEventListener('click', async () => {
            if (!deferredPrompt) return;
            
            deferredPrompt.prompt();
            const { outcome } = await deferredPrompt.userChoice;
            
            if (outcome === 'accepted') {
                elements.installBtn.style.display = 'none';
            }
            
            deferredPrompt = null;
        });
        
        // ============================================
        // ğŸš€ Ø¹Ø±Ø¶ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
        // ============================================
        function showApp() {
            showScreen('chatListScreen');
            loadUserProfile();
            loadContacts();
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø© ÙƒÙ„ 30 Ø«Ø§Ù†ÙŠØ©
            setInterval(() => {
                if (currentUser) {
                    db.collection('users').doc(currentUser.uid).update({
                        lastSeen: firebase.firestore.FieldValue.serverTimestamp()
                    });
                }
            }, 30000);
        }
        
        // ============================================
        // ğŸ¬ Ø¨Ø¯Ø¡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        // ============================================
        function init() {
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¬Ù„
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                try {
                    currentUser = JSON.parse(savedUser);
                    showApp();
                    hideLoading();
                    return;
                } catch (e) {
                    localStorage.removeItem('currentUser');
                }
            }
            
            // Ø¹Ø±Ø¶ Ø´Ø§Ø´Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
            hideLoading();
            showScreen('loginScreen');
            
            // Ø¥Ø¹Ø¯Ø§Ø¯ OTP Inputs
            elements.otpInputs.forEach((input, index) => {
                input.addEventListener('input', (e) => {
                    if (e.target.value.length === 1 && index < 5) {
                        elements.otpInputs[index + 1].focus();
                    }
                });
                
                input.addEventListener('keydown', (e) => {
                    if (e.key === 'Backspace' && !e.target.value && index > 0) {
                        elements.otpInputs[index - 1].focus();
                    }
                });
            });
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø© Ù†Ø¬Ø§Ø­ Ø§Ù„Ø§ØªØµØ§Ù„
            setTimeout(() => {
                showToast('âœ… Ù…ØªØµÙ„ Ø¨Ù€ Firebase Ø¨Ù†Ø¬Ø§Ø­!', 2000);
            }, 1000);
        }
        
        // Ø¨Ø¯Ø¡ Ø§Ù„ØªØ´ØºÙŠÙ„
        document.addEventListener('DOMContentLoaded', () => {
            showLoading('Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„...');
            setTimeout(init, 1000);
        });
    </script>
</body>
    </html>
